# Render Deployment Guide

This guide will help you deploy your Real-time Order Management System to Render using external databases.

## üóÑÔ∏è Prerequisites - External Database Setup

### 1. MongoDB Database
You'll need a MongoDB database. Popular options:
- **MongoDB Atlas** (recommended): Free tier available
- **DigitalOcean Managed MongoDB**
- **AWS DocumentDB**
- **Self-hosted MongoDB**

**MongoDB Atlas Setup:**
1. Go to [MongoDB Atlas](https://www.mongodb.com/atlas)
2. Create a free account and cluster
3. Create a database user
4. Whitelist Render's IP addresses (or use 0.0.0.0/0 for all IPs)
5. Get your connection string (format: `mongodb+srv://username:password@cluster.mongodb.net/database`)

### 2. Redis Database
You'll need an external Redis instance. Popular options:
- **Redis Cloud** (recommended): Free tier available
- **Upstash Redis**: Serverless Redis with free tier
- **DigitalOcean Managed Redis**
- **AWS ElastiCache**

**Redis Cloud Setup:**
1. Go to [Redis Cloud](https://redis.com/redis-enterprise-cloud/)
2. Create a free account
3. Create a new database
4. Choose the free tier (30MB)
5. Get your connection details (host, port, password)

**Upstash Redis Setup:**
1. Go to [Upstash](https://upstash.com/)
2. Sign up for a free account
3. Create a new Redis database
4. Copy the connection details or Redis URL

## üöÄ Render Deployment Steps

### Step 1: Prepare Your Repository
1. Ensure your code is pushed to GitHub/GitLab
2. Make sure the `render.yaml` file is in your repository root
3. Verify both `backend/package.json` and `frontend/package.json` exist

### Step 2: Create Render Account
1. Go to [Render](https://render.com)
2. Sign up and connect your GitHub/GitLab account

### Step 3: Deploy Using Blueprint
1. In Render dashboard, click "New" ‚Üí "Blueprint"
2. Connect your repository
3. Render will detect the `render.yaml` file
4. Click "Apply" to create all services

### Step 4: Configure Environment Variables
After deployment, you need to set the database connection variables:

#### Backend Service Environment Variables
Go to your backend service settings and add these environment variables:

**Required Database Variables:**
```
MONGODB_URI=mongodb+srv://username:password@cluster.mongodb.net/order_management_db
```

**Note:**
- Redis is automatically configured as an internal service
- CORS_ORIGIN is automatically set to the frontend service URL

**Optional External Service Variables:**
```
STRIPE_SECRET_KEY=sk_live_your_stripe_secret_key
STRIPE_WEBHOOK_SECRET=whsec_your_webhook_secret
EMAIL_SERVICE_API_KEY=your_email_api_key
EMAIL_FROM=noreply@yourdomain.com
```

### Step 5: Frontend Environment (Automatic)
The frontend environment variables are automatically configured by the Blueprint:

- `VITE_BACKEND_URL` - Automatically set to your backend service URL
- `VITE_WS_URL` - Automatically set to your backend service URL
- The frontend code automatically appends `/api` to `VITE_BACKEND_URL` for API calls

No manual configuration needed!

## üîß Post-Deployment Configuration

### 1. Database Initialization
- Your MongoDB database will be automatically initialized when the backend starts
- Redis connection will be established using your external Redis service

### 2. Health Checks
- Backend health check: `https://your-backend-service.onrender.com/api/health`
- Frontend: Should be accessible at your frontend URL

### 3. CORS Configuration
The CORS origin is automatically set to your frontend URL. If you need additional origins:
```
CORS_ORIGIN=https://your-frontend.onrender.com,https://yourdomain.com
```

## üîí Security Considerations

### Environment Variables
- All sensitive keys (JWT_SECRET, ENCRYPTION_KEY, etc.) are auto-generated by Render
- Never commit real secrets to your repository
- Use Render's environment variable management

### Database Security
- Use strong passwords for your databases
- Enable authentication on your databases
- Consider IP whitelisting if your database provider supports it

## üìä Monitoring and Logs

### Render Logs
- View logs in Render dashboard for each service
- Monitor deployment status and health checks

### Application Logs
- Backend logs are configured with Winston
- Check Render logs for application-specific messages

## üîÑ Updates and Redeployment

### Automatic Deployments
- Render automatically redeploys when you push to your main branch
- Both frontend and backend will redeploy independently

### Manual Deployment
- Use "Manual Deploy" button in Render dashboard
- Useful for deploying specific commits

## üÜò Troubleshooting

### Common Issues

**Backend won't start:**
- Check environment variables are set correctly
- Verify database connections
- Check Render logs for specific errors

**Frontend can't connect to backend:**
- Verify VITE_API_BASE_URL is correct
- Check CORS configuration
- Ensure backend is running

**Database connection issues:**
- Verify connection strings
- Check database user permissions
- Ensure IP whitelisting includes Render's IPs

### Getting Help
- Check Render documentation
- Review application logs
- Verify all environment variables are set

## üìù Next Steps

After successful deployment:
1. Test all application features
2. Set up monitoring and alerts
3. Configure custom domain (if needed)
4. Set up SSL certificates (automatic with Render)
5. Consider upgrading to paid plans for production use
